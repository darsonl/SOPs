**Malware Infection Playbook**

**Date: 2025/9/16**

**Author: Darson Lai**

**1. Preparation**

- **Preventive Controls**

  - Maintain up‑to‑date endpoint protection (EDR/AV).

  - Enforce MFA and least‑privilege access.

  - Regularly patch OS, applications, and firmware.

  - Maintain offline, immutable, and tested backups.

  - Subscribe to threat intelligence feeds.

- **Readiness**

<!-- -->

- Define escalation paths and roles (SOC, IT, Legal, Comms).

- Pre‑stage forensic tools (EDR, Sysinternals, KAPE).

- Conduct tabletop exercises simulating ransomware.

**2. Detection & Analysis**

**Indicators of compromise:**

- Unusual CPU/disk usage, mass file renaming, or ransom notes.

- Suspicious processes (e.g., vssadmin delete shadows).

- AV/EDR alerts for known malware signatures.

- Network anomalies (C2 traffic, SMB brute force).

**Actions:**

- Validate alerts with SIEM/EDR logs.

- Identify patient zero (first infected host).

- Determine scope: endpoints, servers, cloud workloads.

- Collect forensic artifacts (memory dump, logs, file hashes).

**3. Containment**

- **Short‑term**

  - Immediately isolate infected endpoints (EDR quarantine, network
    disconnect).

  - Disable compromised accounts.

  - Block malicious IPs/domains at firewall.

- **Medium‑term**

<!-- -->

- Segment affected subnets.

- Suspend non‑essential services to reduce spread.

- Preserve evidence before wiping/reimaging.

**4. Eradication**

- Remove malware binaries and persistence mechanisms.

- Patch exploited vulnerabilities.

- Reset credentials (especially privileged accounts).

- Scan the environment for residual infections.

- Validate that C2 traffic has ceased.

**5. Recovery**

- Restore systems from **known‑good, offline backups**.

- Rebuild compromised machines rather than cleaning in place.

- Gradually reconnect systems to the network.

- Monitor closely for reinfection or lateral movement.

- Validate business applications and data integrity.

**6. Post‑Incident Activities**

- **Lessons Learned**

  - Document timeline, root cause, and impact.

  - Assess effectiveness of detection and response.

- **Improvements**

  - Update playbook with new IOCs and TTPs.

  - Enhance monitoring rules (SIEM, EDR).

  - Train staff on phishing and malware awareness.

- **Compliance**

<!-- -->

- Notify regulators/customers if required by law.

- Review cyber insurance and legal obligations.

**7. Communication Plan**

- **Internal:** SOC → IT Ops → Management → Execs.

- **External:**

  - Notify law enforcement / national CERT if required.

  - Engage cyber insurance provider.

  - Prepare factual, non‑speculative public statements.

- **Ransom considerations:**

<!-- -->

- Involve Legal and Executive leadership.

- Never pay without full risk/legal assessment.

- Document all communications with attackers if they occur.
